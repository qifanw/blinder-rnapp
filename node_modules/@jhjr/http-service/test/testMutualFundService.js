/**
 * Created by yanqiu_ge on 2017/12/18. 公募基金产品相关接口
 */
var HttpService = require('../index');
var testIndex = require('./index');
var mutualFundService =HttpService.$getDefaultService().$getMutualFundService();
describe('公募基金首页',function (done) {
  this.timeout(5000);
  it('should return code(0)',function () {
    return mutualFundService.$getIndexList().should.eventually.satisfy(function (obj) {
      return obj.message.code == 0
    }).notify(done);
  })
})
describe('货基产品详情接口', function(done) {
  this.timeout(5000);
  it('should return a right code when code is exists', function () {
    return mutualFundService.$getDesc('000330').should.eventually.satisfy(function (obj) {
      return obj.message.code == 0 && obj.data.code == '000330';
    }).notify(done);
  });
});
describe('非货基产品详情接口', function(done) {
  this.timeout(5000);
  it('should return a right code when code is exists', function () {
    return mutualFundService.$getDesc('470098').should.eventually.satisfy(function (obj) {
      return obj.message.code == 0 && obj.data.code == '470098';
    }).notify(done);
  });
});
function lastMonth() {
    var now = new Date();
    now.setMonth(now.getMonth() - 1);
    return now.getTime()
}
describe('货基产品近一个月的收益曲线数据',function (done) {
  this.timeout(5000);
  it('返回近一个月范围内的数据',function () {
    var start = lastMonth();
    var end =new Date().getTime();
    return mutualFundService.$getYieldCurve('000330',start,end).should.eventually.satisfy(function (obj) {
      return obj.message.code ==0;
    }).notify(done);
  })
})
describe('非货基收益曲线数据',function (done) {
  this.timeout(5000);
  it('返回近一个月范围内的数据', function () {
    var start = lastMonth();
    var end = new Date().getTime();
    return mutualFundService.$getYieldCurve('470098', start, end).should.eventually.satisfy(function (obj) {
      return obj.message.code == 0;
    }).notify(done);
  })
})
describe('公募基金公告',function (done) {
  this.timeout(5000);
  it('should return a right code when code is exists',function () {
    return mutualFundService.$getNotie('000330',1,20).should.eventually.satisfy(function (obj) {
      return obj.message.code ==0;
    }).notify(done);
  })
})
describe('公募基金经理',function (done) {
  this.timeout(5000);
  it('should return a right code when code is exists',function () {
    return mutualFundService.$getManager('000330',1).should.eventually.satisfy(function (obj) {
      return obj.message.code ==0;
    }).notify(done);
  })
})
describe('公募持仓组合',function (done) {
  this.timeout(5000);
  it('should return a right code when code is exists',function () {
    return mutualFundService.$getProportion('000330').should.eventually.satisfy(function (obj) {
      return obj.message.code ==0;
    }).notify(done);
  })
})
describe('公募基金明细',function (done) {
  this.timeout(5000);
  it('should return a right code when code is exists',function () {
    return mutualFundService.$getDesc('000330').should.eventually.satisfy(function (obj) {
      return obj.message.code ==0;
    }).notify(done);
  })
})